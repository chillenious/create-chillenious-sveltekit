Ported from the Lucia open source project, which at the time of writing is no longer maintained.

See https://illuminate.atlassian.net/browse/PD-4835 and https://github.com/lucia-auth/lucia/discussions/1714
